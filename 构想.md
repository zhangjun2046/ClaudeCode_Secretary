# 背景
我是张俊，我想打造一个个人生活助理团队，其中有3个agent角色，作为我的ai分身帮我做一些事。

---

## Subagent 1: 新闻张 (News Agent)

**触发词**: "早上好"

**工作流程**:
1. 接收早晨问候后，自动启动新闻搜集流程
2. 使用Web搜索工具搜刮以下领域的最新新闻：
   - AI领域（大模型、工具、应用）
   - 金融市场动态
   - 股市行情和重要资讯
3. 分析和总结新闻，生成结构化的新闻简报
4. 创建日期文件夹 `YYYY-MM-DD/`
5. 在文件夹内生成 `今日新闻.md`
6. 通过飞书机器人发送新闻摘要给张俊

**所需权限**:
- 网络搜索能力（WebSearch/WebFetch）
- 文件写入权限
- 飞书API调用权限

**输出格式**:
```markdown
# YYYY-MM-DD 今日新闻简报

## AI领域
- [标题] 摘要 | 来源 | 链接

## 金融市场
- [标题] 摘要 | 来源 | 链接

## 股市动态
- [标题] 摘要 | 来源 | 链接

## 今日小结
[AI生成的综合分析]
```

---

## Subagent 2: 教练张 (Health Coach Agent)

**触发词**: "自律"

**工作流程**:
1. 接收"自律"触发词后，主动询问："今天多少斤？"
2. 获取体重数据后：
   - 读取 `context/about_me.md` 中的健身目标、历史体重记录
   - 分析体重变化趋势
   - 计算与目标的差距
3. 基于以下因素生成个性化建议：
   - 当前体重与目标体重的差距
   - 最近一周的体重变化趋势
   - 用户的运动偏好和时间安排
   - 饮食偏好和限制
4. 生成今日健康计划：
   - 推荐运动项目、强度、时长
   - 推荐外卖餐厅和具体菜品（包含大致热量）
5. 在日期文件夹内生成 `健康.md`
6. 更新 `context/about_me.md` 中的体重记录

**所需权限**:
- 读取用户档案
- 文件读写权限
- （可选）外卖平台API查询能力

**输出格式**:
```markdown
# YYYY-MM-DD 健康计划

## 今日体重
- 当前: XX.X kg
- 目标: XX.X kg
- 变化: +/- X.X kg（较昨日）

## 运动建议
- 项目: [跑步/健身/瑜伽等]
- 时长: XX分钟
- 强度: [低/中/高]
- 理由: [基于目标和趋势的分析]

## 饮食建议
### 早餐
- 推荐: [具体餐品]
- 参考店铺: [店名]
- 预估热量: XXX kcal

### 午餐
...

### 晚餐
...

## 今日寄语
[激励的话]
```

---

## Subagent 3: 反思张 (Reflection Agent)

**触发词**: "今工作结束了"

**工作流程**:
1. 接收结束工作信号后，启动引导式对话
2. 多轮深度对话（3-5轮）：
   - 第1轮: "今天主要做了什么工作？"
   - 第2轮: "这些工作中，哪些让你感到有成就感/有挑战？"
   - 第3轮: "你觉得今天的状态怎么样？有什么情绪波动吗？"
   - 第4轮: "从今天的经历中，你学到了什么？"
   - 第5轮: "明天有什么想要改进或尝试的吗？"
3. 基于对话内容，生成结构化反思文档
4. 分析工作模式、情绪状态、成长点
5. 在日期文件夹内生成 `反思.md`
6. （可选）提取关键洞察更新到 `context/insights.md`

**所需权限**:
- 多轮对话状态保持
- 文件写入权限
- 情感分析能力

**输出格式**:
```markdown
# YYYY-MM-DD 工作反思

## 今日工作概览
[对话总结的工作内容]

## 关键事件
- 成就: [具体事项]
- 挑战: [具体事项]

## 状态与情绪
- 整体状态: [良好/一般/疲惫]
- 情绪记录: [具体情绪和触发点]

## 收获与洞察
[从今天经历中提炼的学习点]

## 明日展望
[改进计划和期待]

## AI观察
[基于长期记录的模式分析和建议]
```

---

## 所需上下文文件夹结构

```
ClaudeCode_Secretary/
├── context/                    # 持久化上下文
│   ├── about_me.md            # 个人档案（目标、偏好、基础信息）
│   ├── health_history.md      # 健康历史记录
│   ├── insights.md            # 长期洞察积累
│   └── preferences.md         # 详细偏好设置
│
├── daily_records/             # 每日记录
│   ├── 2025-01-15/
│   │   ├── 今日新闻.md
│   │   ├── 健康.md
│   │   └── 反思.md
│   ├── 2025-01-16/
│   │   └── ...
│   └── ...
│
├── templates/                 # 文档模板
│   ├── news_template.md
│   ├── health_template.md
│   └── reflection_template.md
│
├── agents/                    # Agent配置和提示词
│   ├── news_agent_prompt.md
│   ├── coach_agent_prompt.md
│   └── reflection_agent_prompt.md
│
└── config/                    # 配置文件
    ├── feishu_config.json     # 飞书配置
    └── agent_config.json      # Agent行为配置
```

---

## 所需MCP服务器

### 1. **MCP Fetch** (必需)
- **用途**: 新闻张搜索网络新闻
- **功能**: HTTP请求、网页抓取
- **安装**: `npx @modelcontextprotocol/server-fetch`

### 2. **MCP Filesystem** (必需)
- **用途**: 所有agent读写文件
- **功能**: 文件和文件夹的创建、读取、更新
- **安装**: `npx @modelcontextprotocol/server-filesystem`

### 3. **MCP Memory** (推荐)
- **用途**: 保持对话状态，特别是反思张的多轮对话
- **功能**: 会话记忆、上下文保持
- **安装**: `npx @modelcontextprotocol/server-memory`

### 4. **MCP Brave Search** (推荐)
- **用途**: 新闻张的新闻搜索（比通用fetch更准确）
- **功能**: 结构化搜索结果
- **安装**: 需要Brave Search API密钥
- **配置**: https://brave.com/search/api/

### 5. **自定义 Feishu MCP** (必需)
- **用途**: 发送飞书消息
- **功能**: 调用飞书开放平台API
- **实现**: 需要自己开发或使用第三方MCP
- **所需**: 飞书机器人webhook或应用凭证

### 6. **MCP Time/Calendar** (可选)
- **用途**: 准确的日期时间处理
- **功能**: 获取当前时间、日期格式化
- **安装**: `npx @modelcontextprotocol/server-time`

---

## 实现建议

### Agent触发机制
可以通过Claude Code的自定义命令实现：
- `.claude/commands/早上好.md` → 触发新闻张
- `.claude/commands/自律.md` → 触发教练张
- `.claude/commands/今工作结束了.md` → 触发反思张

### 数据持久化
- 使用 `context/about_me.md` 作为核心用户档案
- 每次交互后更新相关上下文文件
- 使用日期文件夹组织每日输出

### 安全性考虑
- API密钥存储在环境变量中
- 敏感信息不写入git仓库
- 添加 `.gitignore` 排除配置文件